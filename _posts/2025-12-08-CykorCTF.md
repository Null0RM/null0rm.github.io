---
title: (Write-up) Cykor CTF 2025 - Multi Chain Vault
date: 2025-12-08 10:38:00 +0900
math: true
---

![Multi Chain Vault](assets/img/posts/2025-12-08-CykorCTF/multi_chain_vault_thumbnail.png "Multi Chain Vault")

## 문제 source

```js
// SPDX-License-Identifier: UNLICENSED
pragma solidity 0.8.30;

import {HyuunnToken} from "./HyuunnToken.sol";
import {HyuunnVault} from "./HyuunnVault.sol";
import {MockRelayer} from "./MockRelayer.sol";

contract Setup {
    HyuunnVault public HyuunnVaultInstance;
    HyuunnToken public HyuunnTokenInstance;
    MockRelayer public MockRelayerInstance;

    bool chance = true;

    constructor() {
        HyuunnTokenInstance = new HyuunnToken();
        HyuunnVaultInstance = new HyuunnVault(address(HyuunnTokenInstance));
        MockRelayerInstance = new MockRelayer(address(HyuunnVaultInstance), address(HyuunnTokenInstance));

        HyuunnTokenInstance.transfer(address(MockRelayerInstance), 100e18);

        HyuunnVaultInstance.setRelayer(address(MockRelayerInstance));
        HyuunnTokenInstance.setMinter(address(HyuunnVaultInstance));
    }
    
    function isSolved() public returns (bool) {
        
        // Ensure this can only be called once
        if (!chance) {
            return false;
        }
        chance = false;

        MockRelayerInstance.executeQueued();

        try this.testTotalSupplyInvariant() returns (bool ok) {
            if (!ok) return true;
        } catch {
            return true;
        }

        return false;
    }

    function testTotalSupplyInvariant() external view returns (bool) {
        return (
            HyuunnTokenInstance.balanceOf(address(MockRelayerInstance)) +
            HyuunnTokenInstance.balanceOf(address(HyuunnVaultInstance)) +
            HyuunnVaultInstance.totalTrapped()
        ) == 100e18;
    }
}
```

```solidity